# Ticket æ ‡ç­¾ç®¡ç†å·¥å…· - éœ€æ±‚ä¸è®¾è®¡æ–‡æ¡£

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®èƒŒæ™¯

æ„å»ºä¸€ä¸ªç®€å•çš„åŸºäºæ ‡ç­¾åˆ†ç±»å’Œç®¡ç† Ticket çš„å·¥å…·ï¼Œå¸®åŠ©ç”¨æˆ·é«˜æ•ˆåœ°åˆ›å»ºã€ç»„ç»‡å’Œè¿½è¸ªä»»åŠ¡ã€‚

### 1.2 æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯é€‰å‹ |
|------|----------|
| æ•°æ®åº“ | PostgreSQL |
| åç«¯ | Python + FastAPI |
| å‰ç«¯ | TypeScript + Vite + Tailwind CSS + Shadcn/ui |

### 1.3 æ ¸å¿ƒåŠŸèƒ½

- Ticket ç®¡ç†ï¼šåˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤ã€å®Œæˆã€å–æ¶ˆå®Œæˆ
- æ ‡ç­¾ç®¡ç†ï¼šåˆ›å»ºã€åˆ é™¤æ ‡ç­¾
- æ ‡ç­¾ç­›é€‰ï¼šæŒ‰æ ‡ç­¾æŸ¥çœ‹ Ticket åˆ—è¡¨
- æœç´¢åŠŸèƒ½ï¼šæŒ‰æ ‡é¢˜æœç´¢ Ticket

---

## 2. åŠŸèƒ½éœ€æ±‚

### 2.1 Ticket ç®¡ç†

#### 2.1.1 åˆ›å»º Ticket

| é¡¹ç›® | æè¿° |
|------|------|
| åŠŸèƒ½æè¿° | ç”¨æˆ·å¯ä»¥åˆ›å»ºæ–°çš„ Ticket æ¥è®°å½•å¾…åŠäº‹é¡¹æˆ–é—®é¢˜ |
| å‰ç½®æ¡ä»¶ | æ—  |
| æ“ä½œæ­¥éª¤ | 1. ç‚¹å‡»ã€Œæ–°å»º Ticketã€æŒ‰é’®<br>2. å¡«å†™æ ‡é¢˜ï¼ˆå¿…å¡«ï¼‰å’Œæè¿°ï¼ˆå¯é€‰ï¼‰<br>3. é€‰æ‹©å…³è”çš„æ ‡ç­¾ï¼ˆå¯é€‰ï¼Œæ”¯æŒå¤šé€‰ï¼‰<br>4. ç‚¹å‡»ã€Œä¿å­˜ã€æŒ‰é’® |
| é¢„æœŸç»“æœ | Ticket åˆ›å»ºæˆåŠŸï¼Œå‡ºç°åœ¨åˆ—è¡¨ä¸­ï¼ŒçŠ¶æ€ä¸ºã€Œæœªå®Œæˆã€ |
| éªŒæ”¶æ ‡å‡† | - æ ‡é¢˜ä¸èƒ½ä¸ºç©ºï¼Œæœ€å¤§ 255 å­—ç¬¦<br>- æè¿°å¯é€‰ï¼Œæ— é•¿åº¦é™åˆ¶<br>- å¯å…³è” 0 ä¸ªæˆ–å¤šä¸ªæ ‡ç­¾ |

#### 2.1.2 ç¼–è¾‘ Ticket

| é¡¹ç›® | æè¿° |
|------|------|
| åŠŸèƒ½æè¿° | ç”¨æˆ·å¯ä»¥ä¿®æ”¹å·²åˆ›å»ºçš„ Ticket ä¿¡æ¯ |
| å‰ç½®æ¡ä»¶ | Ticket å·²å­˜åœ¨ |
| æ“ä½œæ­¥éª¤ | 1. åœ¨ Ticket åˆ—è¡¨ä¸­ç‚¹å‡»ç›®æ ‡ Ticket çš„ç¼–è¾‘æŒ‰é’®<br>2. ä¿®æ”¹æ ‡é¢˜ã€æè¿°æˆ–æ ‡ç­¾<br>3. ç‚¹å‡»ã€Œä¿å­˜ã€æŒ‰é’® |
| é¢„æœŸç»“æœ | Ticket ä¿¡æ¯æ›´æ–°æˆåŠŸï¼Œåˆ—è¡¨åˆ·æ–°æ˜¾ç¤ºæœ€æ–°å†…å®¹ |
| éªŒæ”¶æ ‡å‡† | - å¯ä¿®æ”¹æ ‡é¢˜ã€æè¿°ã€å…³è”æ ‡ç­¾<br>- ä¿®æ”¹å updated_at æ—¶é—´æ›´æ–° |

#### 2.1.3 åˆ é™¤ Ticket

| é¡¹ç›® | æè¿° |
|------|------|
| åŠŸèƒ½æè¿° | ç”¨æˆ·å¯ä»¥åˆ é™¤ä¸å†éœ€è¦çš„ Ticket |
| å‰ç½®æ¡ä»¶ | Ticket å·²å­˜åœ¨ |
| æ“ä½œæ­¥éª¤ | 1. åœ¨ Ticket åˆ—è¡¨ä¸­ç‚¹å‡»ç›®æ ‡ Ticket çš„åˆ é™¤æŒ‰é’®<br>2. ç¡®è®¤åˆ é™¤æ“ä½œ |
| é¢„æœŸç»“æœ | Ticket è¢«æ°¸ä¹…åˆ é™¤ï¼Œä»åˆ—è¡¨ä¸­ç§»é™¤ |
| éªŒæ”¶æ ‡å‡† | - åˆ é™¤å‰éœ€äºŒæ¬¡ç¡®è®¤<br>- åˆ é™¤åå…³è”çš„æ ‡ç­¾å…³ç³»è‡ªåŠ¨æ¸…é™¤<br>- åˆ é™¤æ“ä½œä¸å¯æ’¤é”€ |

#### 2.1.4 å®Œæˆ Ticket

| é¡¹ç›® | æè¿° |
|------|------|
| åŠŸèƒ½æè¿° | ç”¨æˆ·å¯ä»¥å°† Ticket æ ‡è®°ä¸ºå·²å®ŒæˆçŠ¶æ€ |
| å‰ç½®æ¡ä»¶ | Ticket å·²å­˜åœ¨ä¸”çŠ¶æ€ä¸ºã€Œæœªå®Œæˆã€ |
| æ“ä½œæ­¥éª¤ | ç‚¹å‡» Ticket å‰çš„å¤é€‰æ¡†æˆ–å®ŒæˆæŒ‰é’® |
| é¢„æœŸç»“æœ | Ticket çŠ¶æ€å˜ä¸ºã€Œå·²å®Œæˆã€ï¼Œè§†è§‰ä¸Šæœ‰æ˜æ˜¾åŒºåˆ† |
| éªŒæ”¶æ ‡å‡† | - å·²å®Œæˆçš„ Ticket æ˜¾ç¤ºåˆ é™¤çº¿æˆ–ç°è‰²æ ·å¼<br>- çŠ¶æ€å˜æ›´å updated_at æ—¶é—´æ›´æ–° |

#### 2.1.5 å–æ¶ˆå®Œæˆ Ticket

| é¡¹ç›® | æè¿° |
|------|------|
| åŠŸèƒ½æè¿° | ç”¨æˆ·å¯ä»¥å°†å·²å®Œæˆçš„ Ticket é‡æ–°è®¾ä¸ºæœªå®ŒæˆçŠ¶æ€ |
| å‰ç½®æ¡ä»¶ | Ticket å·²å­˜åœ¨ä¸”çŠ¶æ€ä¸ºã€Œå·²å®Œæˆã€ |
| æ“ä½œæ­¥éª¤ | ç‚¹å‡»å·²å®Œæˆ Ticket çš„å¤é€‰æ¡†æˆ–é‡æ–°æ‰“å¼€æŒ‰é’® |
| é¢„æœŸç»“æœ | Ticket çŠ¶æ€å˜å›ã€Œæœªå®Œæˆã€ |
| éªŒæ”¶æ ‡å‡† | - æ¢å¤æ­£å¸¸æ ·å¼æ˜¾ç¤º<br>- çŠ¶æ€å˜æ›´å updated_at æ—¶é—´æ›´æ–° |

### 2.2 æ ‡ç­¾ç®¡ç†

#### 2.2.1 åˆ›å»ºæ ‡ç­¾

| é¡¹ç›® | æè¿° |
|------|------|
| åŠŸèƒ½æè¿° | ç”¨æˆ·å¯ä»¥åˆ›å»ºæ–°æ ‡ç­¾ç”¨äºåˆ†ç±» Ticket |
| å‰ç½®æ¡ä»¶ | æ—  |
| æ“ä½œæ­¥éª¤ | 1. ç‚¹å‡»ã€Œæ–°å»ºæ ‡ç­¾ã€æŒ‰é’®<br>2. è¾“å…¥æ ‡ç­¾åç§°<br>3. é€‰æ‹©æ ‡ç­¾é¢œè‰²<br>4. ç‚¹å‡»ã€Œä¿å­˜ã€æŒ‰é’® |
| é¢„æœŸç»“æœ | æ ‡ç­¾åˆ›å»ºæˆåŠŸï¼Œå‡ºç°åœ¨æ ‡ç­¾åˆ—è¡¨ä¸­ |
| éªŒæ”¶æ ‡å‡† | - æ ‡ç­¾åç§°ä¸èƒ½ä¸ºç©ºï¼Œæœ€å¤§ 50 å­—ç¬¦<br>- æ ‡ç­¾åç§°ä¸èƒ½é‡å¤<br>- é¢œè‰²ä½¿ç”¨ HEX æ ¼å¼ |

#### 2.2.2 ç¼–è¾‘æ ‡ç­¾

| é¡¹ç›® | æè¿° |
|------|------|
| åŠŸèƒ½æè¿° | ç”¨æˆ·å¯ä»¥ä¿®æ”¹å·²åˆ›å»ºçš„æ ‡ç­¾ä¿¡æ¯ |
| å‰ç½®æ¡ä»¶ | æ ‡ç­¾å·²å­˜åœ¨ |
| æ“ä½œæ­¥éª¤ | 1. ç‚¹å‡»æ ‡ç­¾çš„ç¼–è¾‘æŒ‰é’®<br>2. ä¿®æ”¹åç§°æˆ–é¢œè‰²<br>3. ç‚¹å‡»ã€Œä¿å­˜ã€æŒ‰é’® |
| é¢„æœŸç»“æœ | æ ‡ç­¾ä¿¡æ¯æ›´æ–°æˆåŠŸï¼Œæ‰€æœ‰å…³è”çš„ Ticket æ˜¾ç¤ºæ›´æ–°åçš„æ ‡ç­¾æ ·å¼ |
| éªŒæ”¶æ ‡å‡† | - ä¿®æ”¹åç«‹å³ç”Ÿæ•ˆ<br>- å…³è”å…³ç³»ä¿æŒä¸å˜ |

#### 2.2.3 åˆ é™¤æ ‡ç­¾

| é¡¹ç›® | æè¿° |
|------|------|
| åŠŸèƒ½æè¿° | ç”¨æˆ·å¯ä»¥åˆ é™¤ä¸å†éœ€è¦çš„æ ‡ç­¾ |
| å‰ç½®æ¡ä»¶ | æ ‡ç­¾å·²å­˜åœ¨ |
| æ“ä½œæ­¥éª¤ | 1. ç‚¹å‡»æ ‡ç­¾çš„åˆ é™¤æŒ‰é’®<br>2. ç¡®è®¤åˆ é™¤æ“ä½œ |
| é¢„æœŸç»“æœ | æ ‡ç­¾è¢«æ°¸ä¹…åˆ é™¤ï¼Œæ‰€æœ‰ Ticket ä¸Šçš„è¯¥æ ‡ç­¾è‡ªåŠ¨ç§»é™¤ |
| éªŒæ”¶æ ‡å‡† | - åˆ é™¤å‰éœ€äºŒæ¬¡ç¡®è®¤<br>- åˆ é™¤åä¸å½±å“ Ticket æœ¬èº«<br>- åˆ é™¤æ“ä½œä¸å¯æ’¤é”€ |

### 2.3 Ticket åˆ—è¡¨ä¸ç­›é€‰

#### 2.3.1 æŸ¥çœ‹ Ticket åˆ—è¡¨

| é¡¹ç›® | æè¿° |
|------|------|
| åŠŸèƒ½æè¿° | ç”¨æˆ·å¯ä»¥æŸ¥çœ‹æ‰€æœ‰ Ticket çš„åˆ—è¡¨ |
| å‰ç½®æ¡ä»¶ | æ—  |
| æ“ä½œæ­¥éª¤ | è®¿é—®é¦–é¡µ |
| é¢„æœŸç»“æœ | æ˜¾ç¤ºæ‰€æœ‰ Ticket åˆ—è¡¨ï¼ŒæŒ‰åˆ›å»ºæ—¶é—´å€’åºæ’åˆ— |
| éªŒæ”¶æ ‡å‡† | - æ¯ä¸ª Ticket æ˜¾ç¤ºæ ‡é¢˜ã€çŠ¶æ€ã€å…³è”æ ‡ç­¾<br>- æ”¯æŒåˆ†é¡µåŠ è½½<br>- æœªå®Œæˆçš„ Ticket æ˜¾ç¤ºåœ¨å·²å®Œæˆä¹‹å‰ |

#### 2.3.2 æŒ‰æ ‡ç­¾ç­›é€‰

| é¡¹ç›® | æè¿° |
|------|------|
| åŠŸèƒ½æè¿° | ç”¨æˆ·å¯ä»¥æŒ‰æ ‡ç­¾ç­›é€‰ Ticket åˆ—è¡¨ |
| å‰ç½®æ¡ä»¶ | è‡³å°‘å­˜åœ¨ä¸€ä¸ªæ ‡ç­¾ |
| æ“ä½œæ­¥éª¤ | åœ¨ä¾§è¾¹æ ç‚¹å‡»ç›®æ ‡æ ‡ç­¾ |
| é¢„æœŸç»“æœ | åˆ—è¡¨ä»…æ˜¾ç¤ºåŒ…å«è¯¥æ ‡ç­¾çš„ Ticket |
| éªŒæ”¶æ ‡å‡† | - é€‰ä¸­çš„æ ‡ç­¾æœ‰é«˜äº®æ˜¾ç¤º<br>- å¯å¿«é€Ÿåˆ‡æ¢ä¸åŒæ ‡ç­¾<br>- æä¾›ã€Œå…¨éƒ¨ã€é€‰é¡¹æŸ¥çœ‹æ‰€æœ‰ Ticket |

#### 2.3.3 æŒ‰çŠ¶æ€ç­›é€‰

| é¡¹ç›® | æè¿° |
|------|------|
| åŠŸèƒ½æè¿° | ç”¨æˆ·å¯ä»¥æŒ‰çŠ¶æ€ï¼ˆæœªå®Œæˆ/å·²å®Œæˆï¼‰ç­›é€‰ Ticket |
| å‰ç½®æ¡ä»¶ | æ—  |
| æ“ä½œæ­¥éª¤ | ç‚¹å‡»çŠ¶æ€ç­›é€‰å™¨é€‰æ‹©ç›®æ ‡çŠ¶æ€ |
| é¢„æœŸç»“æœ | åˆ—è¡¨ä»…æ˜¾ç¤ºå¯¹åº”çŠ¶æ€çš„ Ticket |
| éªŒæ”¶æ ‡å‡† | - æ”¯æŒç­›é€‰ï¼šå…¨éƒ¨ã€æœªå®Œæˆã€å·²å®Œæˆ<br>- å¯ä¸æ ‡ç­¾ç­›é€‰ç»„åˆä½¿ç”¨ |

#### 2.3.4 æŒ‰æ ‡é¢˜æœç´¢

| é¡¹ç›® | æè¿° |
|------|------|
| åŠŸèƒ½æè¿° | ç”¨æˆ·å¯ä»¥é€šè¿‡å…³é”®è¯æœç´¢ Ticket |
| å‰ç½®æ¡ä»¶ | æ—  |
| æ“ä½œæ­¥éª¤ | åœ¨æœç´¢æ¡†ä¸­è¾“å…¥å…³é”®è¯ |
| é¢„æœŸç»“æœ | åˆ—è¡¨å®æ—¶æ˜¾ç¤ºæ ‡é¢˜åŒ…å«å…³é”®è¯çš„ Ticket |
| éªŒæ”¶æ ‡å‡† | - æ”¯æŒæ¨¡ç³Šæœç´¢ï¼ˆåŒ…å«å³åŒ¹é…ï¼‰<br>- æœç´¢ä¸åŒºåˆ†å¤§å°å†™<br>- å¯ä¸æ ‡ç­¾ã€çŠ¶æ€ç­›é€‰ç»„åˆä½¿ç”¨<br>- è¾“å…¥é˜²æŠ–ï¼Œé¿å…é¢‘ç¹è¯·æ±‚ |

### 2.4 ç”¨æˆ·ä½“éªŒè¦æ±‚

#### 2.4.1 å“åº”å¼è®¾è®¡

- æ”¯æŒæ¡Œé¢ç«¯ï¼ˆ>1024pxï¼‰å’Œç§»åŠ¨ç«¯ï¼ˆ<768pxï¼‰
- ç§»åŠ¨ç«¯ä¾§è¾¹æ å¯æŠ˜å 

#### 2.4.2 äº¤äº’åé¦ˆ

- æ‰€æœ‰æ“ä½œéœ€è¦æœ‰ Loading çŠ¶æ€æç¤º
- æ“ä½œæˆåŠŸ/å¤±è´¥éœ€æ˜¾ç¤º Toast æç¤º
- è¡¨å•éªŒè¯é”™è¯¯éœ€å³æ—¶æ˜¾ç¤º

#### 2.4.3 æ€§èƒ½è¦æ±‚

- é¡µé¢é¦–æ¬¡åŠ è½½æ—¶é—´ < 2s
- åˆ—è¡¨åŠ è½½æ”¯æŒåˆ†é¡µï¼Œæ¯é¡µé»˜è®¤ 20 æ¡
- æœç´¢è¾“å…¥é˜²æŠ–å»¶è¿Ÿ 300ms

---

## 3. æ•°æ®åº“è®¾è®¡

### 3.1 ER å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    tickets   â”‚       â”‚   ticket_tags    â”‚       â”‚     tags     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)      â”‚â”€â”€â”€â”   â”‚ ticket_id (FK)   â”‚   â”Œâ”€â”€â”€â”‚ id (PK)      â”‚
â”‚ title        â”‚   â””â”€â”€>â”‚ tag_id (FK)      â”‚<â”€â”€â”˜   â”‚ name         â”‚
â”‚ description  â”‚       â”‚ (composite PK)   â”‚       â”‚ color        â”‚
â”‚ status       â”‚       â”‚ created_at       â”‚       â”‚ created_at   â”‚
â”‚ completed_at â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ updated_at   â”‚
â”‚ created_at   â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ updated_at   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 è¡¨ç»“æ„

#### 3.2.1 tickets è¡¨

| å­—æ®µ | ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|------|------|------|------|
| id | UUID | PRIMARY KEY | ä¸»é”® |
| title | VARCHAR(255) | NOT NULL | æ ‡é¢˜ |
| description | TEXT | NULLABLE | æè¿°å†…å®¹ |
| status | VARCHAR(20) | NOT NULL, DEFAULT 'open' | çŠ¶æ€ï¼šopen/completed |
| completed_at | TIMESTAMP | NULLABLE | å®Œæˆæ—¶é—´ |
| created_at | TIMESTAMP | NOT NULL, DEFAULT NOW() | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | NOT NULL, DEFAULT NOW() | æ›´æ–°æ—¶é—´ |

#### 3.2.2 tags è¡¨

| å­—æ®µ | ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|------|------|------|------|
| id | UUID | PRIMARY KEY | ä¸»é”® |
| name | VARCHAR(50) | NOT NULL, UNIQUE | æ ‡ç­¾åç§° |
| color | VARCHAR(7) | NOT NULL, DEFAULT '#6366f1' | æ ‡ç­¾é¢œè‰²ï¼ˆHEXï¼‰ |
| created_at | TIMESTAMP | NOT NULL, DEFAULT NOW() | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | NOT NULL, DEFAULT NOW() | æ›´æ–°æ—¶é—´ |

#### 3.2.3 ticket_tags å…³è”è¡¨

| å­—æ®µ | ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|------|------|------|------|
| ticket_id | UUID | FOREIGN KEY â†’ tickets.id | Ticket ID |
| tag_id | UUID | FOREIGN KEY â†’ tags.id | æ ‡ç­¾ ID |
| created_at | TIMESTAMP | NOT NULL, DEFAULT NOW() | å…³è”åˆ›å»ºæ—¶é—´ |
| PRIMARY KEY | (ticket_id, tag_id) | å¤åˆä¸»é”® | |

### 3.3 SQL å»ºè¡¨è¯­å¥

```sql
-- åˆ›å»º tickets è¡¨
CREATE TABLE tickets (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    title VARCHAR(255) NOT NULL,
    description TEXT,
    status VARCHAR(20) NOT NULL DEFAULT 'open' CHECK (status IN ('open', 'completed')),
    completed_at TIMESTAMP WITH TIME ZONE,
    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW()
);

-- åˆ›å»º tags è¡¨
CREATE TABLE tags (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(50) NOT NULL UNIQUE,
    color VARCHAR(7) NOT NULL DEFAULT '#6366f1',
    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW()
);

-- åˆ›å»º ticket_tags å…³è”è¡¨
CREATE TABLE ticket_tags (
    ticket_id UUID NOT NULL REFERENCES tickets(id) ON DELETE CASCADE,
    tag_id UUID NOT NULL REFERENCES tags(id) ON DELETE CASCADE,
    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
    PRIMARY KEY (ticket_id, tag_id)
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_tickets_status ON tickets(status);
CREATE INDEX idx_tickets_title ON tickets(title);
CREATE INDEX idx_tickets_created_at ON tickets(created_at DESC);
CREATE INDEX idx_ticket_tags_tag_id ON ticket_tags(tag_id);

-- è§¦å‘å™¨å‡½æ•°ï¼šè‡ªåŠ¨æ›´æ–° updated_at
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = NOW();
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- è§¦å‘å™¨å‡½æ•°ï¼šè‡ªåŠ¨è®¾ç½® completed_at
CREATE OR REPLACE FUNCTION update_completed_at_column()
RETURNS TRIGGER AS $$
BEGIN
    -- å½“çŠ¶æ€å˜ä¸º completed æ—¶ï¼Œè®¾ç½®å®Œæˆæ—¶é—´
    IF NEW.status = 'completed' AND (OLD.status IS NULL OR OLD.status != 'completed') THEN
        NEW.completed_at = NOW();
    -- å½“çŠ¶æ€ä» completed å˜ä¸ºå…¶ä»–çŠ¶æ€æ—¶ï¼Œæ¸…ç©ºå®Œæˆæ—¶é—´
    ELSIF NEW.status != 'completed' AND OLD.status = 'completed' THEN
        NEW.completed_at = NULL;
    END IF;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- tickets è¡¨è§¦å‘å™¨
CREATE TRIGGER trigger_tickets_updated_at
    BEFORE UPDATE ON tickets
    FOR EACH ROW
    EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER trigger_tickets_completed_at
    BEFORE UPDATE ON tickets
    FOR EACH ROW
    EXECUTE FUNCTION update_completed_at_column();

-- tags è¡¨è§¦å‘å™¨
CREATE TRIGGER trigger_tags_updated_at
    BEFORE UPDATE ON tags
    FOR EACH ROW
    EXECUTE FUNCTION update_updated_at_column();
```

---

## 4. API è®¾è®¡

### 4.1 åŸºç¡€ä¿¡æ¯

- Base URL: `http://localhost:8000/api/v1`
- Content-Type: `application/json`

### 4.2 Ticket æ¥å£

#### 4.2.1 è·å– Ticket åˆ—è¡¨

```
GET /tickets
```

**Query å‚æ•°ï¼š**
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| tag_ids | UUID[] | å¦ | æŒ‰æ ‡ç­¾ç­›é€‰ï¼Œæ”¯æŒå¤šä¸ªï¼ˆé€—å·åˆ†éš”ï¼‰ï¼Œè¿”å›åŒ…å«ä»»æ„ä¸€ä¸ªæ ‡ç­¾çš„ Ticket |
| status | string | å¦ | æŒ‰çŠ¶æ€ç­›é€‰ï¼šopen/completed |
| search | string | å¦ | æŒ‰æ ‡é¢˜æœç´¢ï¼ˆæ¨¡ç³ŠåŒ¹é…ï¼‰ |
| sort_by | string | å¦ | æ’åºå­—æ®µï¼šcreated_at/updated_at/completed_at/titleï¼Œé»˜è®¤ created_at |
| sort_order | string | å¦ | æ’åºæ–¹å‘ï¼šasc/descï¼Œé»˜è®¤ desc |
| page | int | å¦ | é¡µç ï¼Œé»˜è®¤ 1 |
| page_size | int | å¦ | æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ 20 |

**è¯·æ±‚ç¤ºä¾‹ï¼š**

```
GET /tickets?tag_ids=uuid1,uuid2&status=open&sort_by=updated_at&sort_order=desc
```

**å“åº”ç¤ºä¾‹ï¼š**

```json
{
  "items": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "title": "ä¿®å¤ç™»å½•é—®é¢˜",
      "description": "ç”¨æˆ·æ— æ³•æ­£å¸¸ç™»å½•ç³»ç»Ÿ",
      "status": "open",
      "completed_at": null,
      "tags": [
        {"id": "...", "name": "bug", "color": "#ef4444"}
      ],
      "created_at": "2026-01-10T10:00:00Z",
      "updated_at": "2026-01-10T10:00:00Z"
    }
  ],
  "total": 100,
  "page": 1,
  "page_size": 20
}
```

#### 4.2.2 è·å–å•ä¸ª Ticket

```
GET /tickets/{ticket_id}
```

**å“åº”ç¤ºä¾‹ï¼š**

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "title": "ä¿®å¤ç™»å½•é—®é¢˜",
  "description": "ç”¨æˆ·æ— æ³•æ­£å¸¸ç™»å½•ç³»ç»Ÿ",
  "status": "open",
  "completed_at": null,
  "tags": [
    {"id": "...", "name": "bug", "color": "#ef4444"}
  ],
  "created_at": "2026-01-10T10:00:00Z",
  "updated_at": "2026-01-10T10:00:00Z"
}
```

#### 4.2.3 åˆ›å»º Ticket

```
POST /tickets
```

**è¯·æ±‚ä½“ï¼š**

```json
{
  "title": "ä¿®å¤ç™»å½•é—®é¢˜",
  "description": "ç”¨æˆ·æ— æ³•æ­£å¸¸ç™»å½•ç³»ç»Ÿ",
  "tag_ids": ["550e8400-e29b-41d4-a716-446655440001"]
}
```

**å“åº”ï¼š** è¿”å›åˆ›å»ºçš„ Ticket å¯¹è±¡

#### 4.2.4 æ›´æ–° Ticket

```
PUT /tickets/{ticket_id}
```

**è¯·æ±‚ä½“ï¼š**

```json
{
  "title": "ä¿®å¤ç™»å½•é—®é¢˜ï¼ˆç´§æ€¥ï¼‰",
  "description": "æ›´æ–°åçš„æè¿°",
  "tag_ids": ["550e8400-e29b-41d4-a716-446655440001"]
}
```

**å“åº”ï¼š** è¿”å›æ›´æ–°åçš„ Ticket å¯¹è±¡

#### 4.2.5 åˆ é™¤ Ticket

```
DELETE /tickets/{ticket_id}
```

**å“åº”ï¼š**

```json
{
  "success": true
}
```

#### 4.2.6 å®Œæˆ Ticket

```
PATCH /tickets/{ticket_id}/complete
```

**å“åº”ï¼š** è¿”å›æ›´æ–°åçš„ Ticket å¯¹è±¡ï¼ˆstatus = "completed"ï¼‰

#### 4.2.7 å–æ¶ˆå®Œæˆ Ticket

```
PATCH /tickets/{ticket_id}/reopen
```

**å“åº”ï¼š** è¿”å›æ›´æ–°åçš„ Ticket å¯¹è±¡ï¼ˆstatus = "open"ï¼‰

#### 4.2.8 æ·»åŠ æ ‡ç­¾åˆ° Ticket

```
POST /tickets/{ticket_id}/tags
```

**è¯·æ±‚ä½“ï¼š**

```json
{
  "tag_ids": ["550e8400-e29b-41d4-a716-446655440001", "550e8400-e29b-41d4-a716-446655440002"]
}
```

**å“åº”ï¼š** è¿”å›æ›´æ–°åçš„ Ticket å¯¹è±¡ï¼ˆåŒ…å«æ–°æ·»åŠ çš„æ ‡ç­¾ï¼‰

**è¯´æ˜ï¼š**

- æ”¯æŒæ‰¹é‡æ·»åŠ å¤šä¸ªæ ‡ç­¾
- å·²å­˜åœ¨çš„æ ‡ç­¾å…³è”ä¼šè¢«å¿½ç•¥ï¼ˆä¸ä¼šé‡å¤æ·»åŠ ï¼‰

#### 4.2.9 ä» Ticket ç§»é™¤æ ‡ç­¾

```
DELETE /tickets/{ticket_id}/tags
```

**è¯·æ±‚ä½“ï¼š**

```json
{
  "tag_ids": ["550e8400-e29b-41d4-a716-446655440001"]
}
```

**å“åº”ï¼š** è¿”å›æ›´æ–°åçš„ Ticket å¯¹è±¡ï¼ˆä¸å†åŒ…å«å·²ç§»é™¤çš„æ ‡ç­¾ï¼‰

**è¯´æ˜ï¼š**

- æ”¯æŒæ‰¹é‡ç§»é™¤å¤šä¸ªæ ‡ç­¾
- ä¸å­˜åœ¨çš„æ ‡ç­¾å…³è”ä¼šè¢«å¿½ç•¥

### 4.3 æ ‡ç­¾æ¥å£

#### 4.3.1 è·å–æ ‡ç­¾åˆ—è¡¨

```
GET /tags
```

**å“åº”ç¤ºä¾‹ï¼š**

```json
{
  "items": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440001",
      "name": "bug",
      "color": "#ef4444",
      "ticket_count": 5,
      "created_at": "2026-01-10T10:00:00Z",
      "updated_at": "2026-01-10T10:00:00Z"
    }
  ]
}
```

#### 4.3.2 åˆ›å»ºæ ‡ç­¾

```
POST /tags
```

**è¯·æ±‚ä½“ï¼š**

```json
{
  "name": "bug",
  "color": "#ef4444"
}
```

**å“åº”ï¼š** è¿”å›åˆ›å»ºçš„æ ‡ç­¾å¯¹è±¡

#### 4.3.3 æ›´æ–°æ ‡ç­¾

```
PUT /tags/{tag_id}
```

**è¯·æ±‚ä½“ï¼š**

```json
{
  "name": "critical-bug",
  "color": "#dc2626"
}
```

**å“åº”ï¼š** è¿”å›æ›´æ–°åçš„æ ‡ç­¾å¯¹è±¡

#### 4.3.4 åˆ é™¤æ ‡ç­¾

```
DELETE /tags/{tag_id}
```

**å“åº”ï¼š**

```json
{
  "success": true
}
```

---

## 5. å‰ç«¯è®¾è®¡

### 5.1 é¡µé¢ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Header                                  â”‚
â”‚  Logo                                    [+ æ–°å»º Ticket]         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           â”‚                                                      â”‚
â”‚  Sidebar  â”‚                   Main Content                       â”‚
â”‚           â”‚                                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æœç´¢æ¡† â”‚ â”‚  â”‚  ğŸ” æœç´¢ Ticket...                              â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                                                      â”‚
â”‚  çŠ¶æ€ç­›é€‰  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â˜ ä¿®å¤ç™»å½•é—®é¢˜                    [bug] [ç´§æ€¥] â”‚ â”‚
â”‚ â”‚ â—‹ æ‰€æœ‰ â”‚ â”‚  â”‚     ç”¨æˆ·æ— æ³•æ­£å¸¸ç™»å½•...                         â”‚ â”‚
â”‚ â”‚ â—‹ è¿›è¡Œä¸­â”‚ â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ â—‹ å·²å®Œæˆâ”‚ â”‚  â”‚  â˜‘ å®Œæˆç”¨æˆ·æ³¨å†ŒåŠŸèƒ½              [feature]     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚     å®ç°ç”¨æˆ·æ³¨å†Œ...                              â”‚ â”‚
â”‚           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  æ ‡ç­¾ç­›é€‰  â”‚                                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚                                                      â”‚
â”‚ â”‚ â˜‘ å…¨éƒ¨ â”‚ â”‚                                                      â”‚
â”‚ â”‚ â˜ bug  â”‚ â”‚                                                      â”‚
â”‚ â”‚ â˜ ç´§æ€¥ â”‚ â”‚                                                      â”‚
â”‚ â”‚ â˜ åŠŸèƒ½ â”‚ â”‚                                                      â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                                      â”‚
â”‚           â”‚                                                      â”‚
â”‚[+ æ–°æ ‡ç­¾] â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Sidebar è¯´æ˜ï¼š**

| åŒºåŸŸ | åŠŸèƒ½ |
|------|------|
| æœç´¢æ¡† | æŒ‰æ ‡é¢˜æœç´¢ Ticket |
| çŠ¶æ€ç­›é€‰ | å•é€‰ï¼šæ‰€æœ‰ / è¿›è¡Œä¸­ / å·²å®Œæˆ |
| æ ‡ç­¾ç­›é€‰ | å¤šé€‰ï¼šæ”¯æŒé€‰æ‹©å¤šä¸ªæ ‡ç­¾ï¼Œæ˜¾ç¤ºåŒ…å«ä»»æ„é€‰ä¸­æ ‡ç­¾çš„ Ticket |
| æ–°æ ‡ç­¾æŒ‰é’® | å¿«é€Ÿåˆ›å»ºæ–°æ ‡ç­¾ |

### 5.2 é¡µé¢æ¸…å•

| é¡µé¢ | è·¯ç”± | åŠŸèƒ½ |
|------|------|------|
| é¦–é¡µ/Ticket åˆ—è¡¨ | `/` | å±•ç¤ºæ‰€æœ‰ Ticketï¼Œæ”¯æŒç­›é€‰å’Œæœç´¢ |
| æ–°å»º Ticket | `/tickets/new` | åˆ›å»ºæ–° Ticketï¼ˆModalï¼‰ |
| ç¼–è¾‘ Ticket | `/tickets/:id/edit` | ç¼–è¾‘ç°æœ‰ Ticketï¼ˆModalï¼‰ |
| æ ‡ç­¾ç®¡ç† | `/tags` | ç®¡ç†æ‰€æœ‰æ ‡ç­¾ï¼ˆModal æˆ–ä¾§è¾¹æ ï¼‰ |

### 5.3 ç»„ä»¶ç»“æ„

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”œâ”€â”€ Header.tsx          # é¡¶éƒ¨å¯¼èˆªæ 
â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx         # ä¾§è¾¹æ ï¼ˆçŠ¶æ€ç­›é€‰ + æ ‡ç­¾ç­›é€‰ï¼‰
â”‚   â”‚   â””â”€â”€ MainLayout.tsx      # ä¸»å¸ƒå±€
â”‚   â”œâ”€â”€ tickets/
â”‚   â”‚   â”œâ”€â”€ TicketList.tsx      # Ticket åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ TicketCard.tsx      # Ticket å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ TicketForm.tsx      # Ticket è¡¨å•ï¼ˆæ–°å»º/ç¼–è¾‘ï¼‰
â”‚   â”‚   â””â”€â”€ TicketSearch.tsx    # æœç´¢æ¡†
â”‚   â”œâ”€â”€ filters/
â”‚   â”‚   â”œâ”€â”€ StatusFilter.tsx    # çŠ¶æ€ç­›é€‰ï¼ˆæ‰€æœ‰/è¿›è¡Œä¸­/å·²å®Œæˆï¼‰
â”‚   â”‚   â””â”€â”€ TagFilter.tsx       # æ ‡ç­¾ç­›é€‰ï¼ˆå¤šé€‰ï¼‰
â”‚   â”œâ”€â”€ tags/
â”‚   â”‚   â”œâ”€â”€ TagList.tsx         # æ ‡ç­¾ç®¡ç†åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ TagBadge.tsx        # æ ‡ç­¾å¾½ç« 
â”‚   â”‚   â”œâ”€â”€ TagForm.tsx         # æ ‡ç­¾è¡¨å•
â”‚   â”‚   â””â”€â”€ TagSelector.tsx     # æ ‡ç­¾é€‰æ‹©å™¨ï¼ˆç”¨äº Ticket è¡¨å•ï¼‰
â”‚   â””â”€â”€ ui/                     # Shadcn ç»„ä»¶
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useTickets.ts           # Ticket æ•°æ® Hook
â”‚   â”œâ”€â”€ useTags.ts              # æ ‡ç­¾æ•°æ® Hook
â”‚   â””â”€â”€ useFilters.ts           # ç­›é€‰çŠ¶æ€ Hook
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ api.ts                  # API å®¢æˆ·ç«¯
â”‚   â””â”€â”€ utils.ts                # å·¥å…·å‡½æ•°
â”œâ”€â”€ types/
â”‚   â””â”€â”€ index.ts                # TypeScript ç±»å‹å®šä¹‰
â””â”€â”€ App.tsx
```

### 5.4 æ ¸å¿ƒç»„ä»¶è®¾è®¡

#### 5.4.1 TicketCard ç»„ä»¶

```tsx
interface TicketCardProps {
  ticket: Ticket;
  onComplete: (id: string) => void;
  onReopen: (id: string) => void;
  onEdit: (id: string) => void;
  onDelete: (id: string) => void;
}
```

åŠŸèƒ½ï¼š

- æ˜¾ç¤º Ticket æ ‡é¢˜ã€æè¿°é¢„è§ˆã€çŠ¶æ€
- æ˜¾ç¤ºå…³è”çš„æ ‡ç­¾ï¼ˆå½©è‰²å¾½ç« ï¼‰
- æä¾›å®Œæˆ/å–æ¶ˆå®Œæˆçš„å¤é€‰æ¡†
- æä¾›ç¼–è¾‘ã€åˆ é™¤æ“ä½œèœå•

#### 5.4.2 TagSelector ç»„ä»¶

```tsx
interface TagSelectorProps {
  selectedTagIds: string[];
  onChange: (tagIds: string[]) => void;
  allowCreate?: boolean;
}
```

åŠŸèƒ½ï¼š

- å¤šé€‰æ ‡ç­¾
- æ”¯æŒå¿«é€Ÿåˆ›å»ºæ–°æ ‡ç­¾
- æ˜¾ç¤ºæ ‡ç­¾é¢œè‰²

#### 5.4.3 StatusFilter ç»„ä»¶

```tsx
type TicketStatus = 'all' | 'open' | 'completed';

interface StatusFilterProps {
  value: TicketStatus;
  onChange: (status: TicketStatus) => void;
}
```

åŠŸèƒ½ï¼š

- å•é€‰çŠ¶æ€ç­›é€‰
- ä¸‰ä¸ªé€‰é¡¹ï¼šæ‰€æœ‰ã€è¿›è¡Œä¸­ã€å·²å®Œæˆ
- é€‰ä¸­çŠ¶æ€é«˜äº®æ˜¾ç¤º

#### 5.4.4 TagFilter ç»„ä»¶

```tsx
interface TagFilterProps {
  selectedTagIds: string[];
  onChange: (tagIds: string[]) => void;
}
```

åŠŸèƒ½ï¼š

- å¤šé€‰æ ‡ç­¾ç­›é€‰
- æ˜¾ç¤ºæ¯ä¸ªæ ‡ç­¾å…³è”çš„ Ticket æ•°é‡
- æ”¯æŒå…¨é€‰/å–æ¶ˆå…¨é€‰
- æ ‡ç­¾é¢œè‰²æ˜¾ç¤º

### 5.5 çŠ¶æ€ç®¡ç†

ä½¿ç”¨ React Query (TanStack Query) è¿›è¡ŒæœåŠ¡ç«¯çŠ¶æ€ç®¡ç†ï¼š

```typescript
// hooks/useTickets.ts
export function useTickets(filters: TicketFilters) {
  return useQuery({
    queryKey: ['tickets', filters],
    queryFn: () => ticketApi.getList(filters),
  });
}

export function useCreateTicket() {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: ticketApi.create,
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['tickets'] });
    },
  });
}
```

---

## 6. ç±»å‹å®šä¹‰

### 6.1 åç«¯ Pydantic Models

```python
from pydantic import BaseModel
from datetime import datetime
from uuid import UUID
from typing import Optional, List

class TagBase(BaseModel):
    name: str
    color: str = "#6366f1"

class TagCreate(TagBase):
    pass

class TagUpdate(TagBase):
    pass

class Tag(TagBase):
    id: UUID
    created_at: datetime
    updated_at: datetime
    ticket_count: Optional[int] = None

    class Config:
        from_attributes = True

class TicketBase(BaseModel):
    title: str
    description: Optional[str] = None

class TicketCreate(TicketBase):
    tag_ids: List[UUID] = []

class TicketUpdate(TicketBase):
    tag_ids: List[UUID] = []

class Ticket(TicketBase):
    id: UUID
    status: str
    completed_at: Optional[datetime] = None
    tags: List[Tag]
    created_at: datetime
    updated_at: datetime

    class Config:
        from_attributes = True
```

### 6.2 å‰ç«¯ TypeScript Types

```typescript
// types/index.ts

export interface Tag {
  id: string;
  name: string;
  color: string;
  ticketCount?: number;
  createdAt: string;
  updatedAt: string;
}

export interface Ticket {
  id: string;
  title: string;
  description: string | null;
  status: 'open' | 'completed';
  completedAt: string | null;
  tags: Tag[];
  createdAt: string;
  updatedAt: string;
}

export interface CreateTicketInput {
  title: string;
  description?: string;
  tagIds: string[];
}

export interface UpdateTicketInput {
  title: string;
  description?: string;
  tagIds: string[];
}

export interface TicketFilters {
  tagIds?: string[];
  status?: 'open' | 'completed';
  search?: string;
  sortBy?: 'created_at' | 'updated_at' | 'completed_at' | 'title';
  sortOrder?: 'asc' | 'desc';
  page?: number;
  pageSize?: number;
}

export interface PaginatedResponse<T> {
  items: T[];
  total: number;
  page: number;
  pageSize: number;
}
```

---

## 7. é¡¹ç›®ç»“æ„

```
w1/project-alpha/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ main.py              # FastAPI å…¥å£
â”‚   â”‚   â”œâ”€â”€ config.py            # é…ç½®
â”‚   â”‚   â”œâ”€â”€ database.py          # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â”œâ”€â”€ models/              # SQLAlchemy Models
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ ticket.py
â”‚   â”‚   â”‚   â””â”€â”€ tag.py
â”‚   â”‚   â”œâ”€â”€ schemas/             # Pydantic Schemas
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ ticket.py
â”‚   â”‚   â”‚   â””â”€â”€ tag.py
â”‚   â”‚   â”œâ”€â”€ routers/             # API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ tickets.py
â”‚   â”‚   â”‚   â””â”€â”€ tags.py
â”‚   â”‚   â””â”€â”€ services/            # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ ticket_service.py
â”‚   â”‚       â””â”€â”€ tag_service.py
â”‚   â”œâ”€â”€ alembic/                 # æ•°æ®åº“è¿ç§»
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â””â”€â”€ alembic.ini
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”œâ”€â”€ App.tsx
â”‚   â”‚   â””â”€â”€ main.tsx
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tailwind.config.js
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â””â”€â”€ vite.config.ts
â””â”€â”€ docker-compose.yml           # æœ¬åœ°å¼€å‘ç¯å¢ƒ
```

---

## 8. å¼€å‘ç¯å¢ƒé…ç½®

### 8.1 Docker Compose

```yaml
version: '3.8'
services:
  db:
    image: postgres:16-alpine
    environment:
      POSTGRES_USER: ticketapp
      POSTGRES_PASSWORD: ticketapp
      POSTGRES_DB: ticketapp
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
```

### 8.2 åç«¯ä¾èµ– (requirements.txt)

```
fastapi==0.109.0
uvicorn[standard]==0.27.0
sqlalchemy==2.0.25
psycopg2-binary==2.9.9
alembic==1.13.1
pydantic==2.5.3
python-dotenv==1.0.0
```

### 8.3 å‰ç«¯ä¾èµ– (package.json æ ¸å¿ƒä¾èµ–)

```json
{
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-router-dom": "^6.22.0",
    "@tanstack/react-query": "^5.17.0",
    "axios": "^1.6.5",
    "clsx": "^2.1.0",
    "tailwind-merge": "^2.2.0"
  },
  "devDependencies": {
    "typescript": "^5.3.3",
    "vite": "^5.0.11",
    "tailwindcss": "^3.4.1",
    "autoprefixer": "^10.4.17",
    "postcss": "^8.4.33"
  }
}
```

---

## 9. UI è®¾è®¡è§„èŒƒ

### 9.1 é…è‰²æ–¹æ¡ˆ

| ç”¨é€” | é¢œè‰² | HEX |
|------|------|-----|
| ä¸»è‰²è°ƒ | Indigo | #6366f1 |
| æˆåŠŸ | Green | #22c55e |
| è­¦å‘Š | Amber | #f59e0b |
| é”™è¯¯ | Red | #ef4444 |
| èƒŒæ™¯ | Slate | #f8fafc |
| æ–‡å­— | Slate | #1e293b |

### 9.2 é¢„è®¾æ ‡ç­¾é¢œè‰²

```typescript
const TAG_COLORS = [
  '#ef4444', // Red
  '#f97316', // Orange
  '#f59e0b', // Amber
  '#22c55e', // Green
  '#14b8a6', // Teal
  '#3b82f6', // Blue
  '#6366f1', // Indigo
  '#8b5cf6', // Violet
  '#ec4899', // Pink
  '#6b7280', // Gray
];
```

---

## 10. é”™è¯¯å¤„ç†

### 10.1 API é”™è¯¯å“åº”æ ¼å¼

```json
{
  "detail": {
    "code": "TICKET_NOT_FOUND",
    "message": "Ticket ä¸å­˜åœ¨"
  }
}
```

### 10.2 é”™è¯¯ç å®šä¹‰

| é”™è¯¯ç  | HTTP çŠ¶æ€ç  | è¯´æ˜ |
|--------|-------------|------|
| TICKET_NOT_FOUND | 404 | Ticket ä¸å­˜åœ¨ |
| TAG_NOT_FOUND | 404 | æ ‡ç­¾ä¸å­˜åœ¨ |
| TAG_NAME_EXISTS | 400 | æ ‡ç­¾åç§°å·²å­˜åœ¨ |
| VALIDATION_ERROR | 422 | å‚æ•°éªŒè¯å¤±è´¥ |

---

## 11. åç»­æ‰©å±•å»ºè®®

1. **ç”¨æˆ·ç³»ç»Ÿ**ï¼šæ·»åŠ ç”¨æˆ·è®¤è¯å’Œæƒé™ç®¡ç†
2. **Ticket ä¼˜å…ˆçº§**ï¼šæ·»åŠ ä¼˜å…ˆçº§å­—æ®µï¼ˆä½/ä¸­/é«˜/ç´§æ€¥ï¼‰
3. **Ticket è¯„è®º**ï¼šæ”¯æŒåœ¨ Ticket ä¸‹æ·»åŠ è¯„è®º
4. **Ticket é™„ä»¶**ï¼šæ”¯æŒä¸Šä¼ é™„ä»¶
5. **æ‰¹é‡æ“ä½œ**ï¼šæ‰¹é‡åˆ é™¤ã€æ‰¹é‡æ‰“æ ‡ç­¾
6. **å¯¼å‡ºåŠŸèƒ½**ï¼šå¯¼å‡º Ticket åˆ—è¡¨ä¸º CSV/Excel
7. **ç»Ÿè®¡çœ‹æ¿**ï¼šæŒ‰æ ‡ç­¾ã€çŠ¶æ€ç»Ÿè®¡ Ticket æ•°é‡
